<?php
$home = $this->getParam('home', '');
?>

<div class="cover">
    <div class="zone xl">

        <h1 class="margin-bottom margin-top">Projects</h1>

        <ul class="margin-bottom-xl clear">
            <li class="pull-start margin-end margin-bottom-small"><a href="<?php echo $home; ?>/docs" target="_blank" rel="noopener" class="link-animation-enabled"><i class="icon-book-open"></i> &nbsp;Docs</a></li>
            <li class="pull-start margin-end margin-bottom-small"><a href="<?php echo $home; ?>/support" target="_blank" rel="noopener" class="link-animation-enabled"><i class="icon-lifebuoy"></i> &nbsp;Support</a></li>
        </ul>
    </div>
</div>

<section class="zone xl margin-bottom margin-top-negative-xl">
    <div class="margin-bottom-xl"
        data-service="projects.list"
        data-param-search="{{router.params.search}}"
        data-param-queries="limit(<?php echo APP_PAGING_LIMIT; ?>),offset({{router.params.offset|orZero}}),orderDesc('')"
        data-param-queries-cast-to="array"
        data-param-queries-cast-from="csv"
        data-scope="console"
        data-event="load,projects.create"
        data-name="console-projects"
        data-success="trigger"
        data-success-param-trigger-events="projects.list">

        <div data-ls-if="0 == {{console-projects.projects.length}}" class="box margin-bottom" style="display: none">
            <h3 class="margin-bottom-small text-bold">Get Started</h3>

            <p class="margin-bottom-no">No Projects Found, Create your first project now.</p>
        </div>

        <ul data-ls-loop="console-projects.projects" data-ls-as="project" data-ls-append="" class="tiles cell-3">
            <li class="margin-bottom">
                <a data-ls-attrs="href=/console/home?project={{project.$id}}" class="box">
                    <div data-ls-bind="{{project.name}}" class="text-one-liner margin-bottom-tiny text-bold">&nbsp;</div>

                    <p data-ls-if="({{project.platforms.length}})" class="text-fade text-size-small" data-ls-bind="{{project.platforms.length}} apps"></p>
                    <p data-ls-if="(!{{project.platforms.length}})" class="text-fade text-size-small">&nbsp;</p>

                    <div>
                        <i class="icon-right-open"></i>
                    </div>
                </a>
            </li>
        </ul>

        <div class="pull-end paging">
            <form
                data-service="projects.list"
                data-event="submit"
                data-param-function-id="{{router.params.id}}"
                data-param-search="{{router.params.search}}"
                data-scope="console"
                data-name="console-projects"
                data-success="state"
                data-success-param-state-keys="search,offset">
                <input type="hidden" name="offset">
                <button name="queries" data-cast-to="array" data-cast-from="csv" data-paging-back data-paging-desc data-offset="{{router.params.offset}}" data-total="{{console-projects.total}}" class="margin-end round small" aria-label="Back"><i class="icon-left-open"></i></button>
            </form>

            <span data-ls-bind="{{router.params.offset|pageCurrent}} / {{console-projects.total|pageTotal}}"></span>

            <form
                data-service="projects.list"
                data-event="submit"
                data-param-function-id="{{router.params.id}}"
                data-param-search="{{router.params.search}}"
                data-scope="console"
                data-name="console-projects"
                data-success="state"
                data-success-param-state-keys="search,offset">
                <input type="hidden" name="offset">
                <button name="queries" data-cast-to="array" data-cast-from="csv" data-paging-next data-paging-desc data-offset="{{router.params.offset}}" data-total="{{console-projects.total}}" class="margin-start round small" aria-label="Next"><i class="icon-right-open"></i></button>
            </form>
        </div>

        <button data-ls-ui-trigger="create-project">Create Project</button>
    </div>

</section>
